{
  "comments": [
    {
      "key": {
        "uuid": "294b78b9_ad71984d",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 304,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-01-31T16:01:40Z",
      "side": 1,
      "message": "I slightly prefer keeping V8_TYPED_ARRAY_MAX_SIZE_IN_HEAP so a text search will find all related occurrences here and in C++. I realize that\u0027s not the case for others here (e.g. kTypedArrayMaxByteLength -\u003e FixedTypedArrayBase::kMaxByteLength) but imo it\u0027s a useful property to preserve.",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb92cd56_83fe6b05",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 304,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-02-01T01:13:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "294b78b9_ad71984d",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7655027d_c25a4bb0",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 311,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-01-31T16:01:40Z",
      "side": 1,
      "message": "This is a bit weird; it\u0027s only the \u0027aligned header size\u0027 after the entire operation, which is\n\n (header + mask) \u0026 ~mask\n\nMaybe we can express that more nicely somehow and remove these declarations.",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4ed9750_03c244a9",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 311,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-01-31T16:14:24Z",
      "side": 1,
      "message": "Just to be clear the entire operation is actually:\n\n  (var_byte_length + (kHeader + kMask)) \u0026 ~kMask\n\nSo unfortunately we can\u0027t just roll `(header + mask) \u0026 ~mask` into a single constant.",
      "parentUuid": "7655027d_c25a4bb0",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d15f5967_6837cedc",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 311,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-02-01T08:36:27Z",
      "side": 1,
      "message": "Reading the original code, it appears the relevant part is that we align `word_byte_length`; FixedTypedArrayBase::kHeaderSize is already guaranteed to be aligned. The reason the sequence is a bit strange (it adds kHeaderSize + kObjectAlignmentMask) is probably to save runtime instructions - we can add the constants at compile time.\n\nWdyt about either exposing only kObjectAlignmentMask and doing the rest in tq code; or move this bit to a \u0027Align\u0027 CSA helper?",
      "parentUuid": "a4ed9750_03c244a9",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b2dbbda_9d73d2e1",
        "filename": "src/builtins/base.tq",
        "patchSetId": 7
      },
      "lineNbr": 311,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-02-01T14:41:54Z",
      "side": 1,
      "message": "Done, Only exposing kHeaderSize and kObjectAlignmentMask",
      "parentUuid": "d15f5967_6837cedc",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b71cad20_0b70dc7c",
        "filename": "src/code-stub-assembler.cc",
        "patchSetId": 7
      },
      "lineNbr": 2013,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-01-31T16:01:40Z",
      "side": 1,
      "message": "I don\u0027t get the point of this ExternalReference; it looks like a constant containing \u0027FixedTypedArrayBase::kDataOffset - kHeapObjectTag\u0027 would be the better solution?",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "374e4654_0d1cd183",
        "filename": "src/code-stub-assembler.cc",
        "patchSetId": 7
      },
      "lineNbr": 2013,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-01-31T16:16:59Z",
      "side": 1,
      "message": "I can go back to using `FixedTypedArrayBase::kDataOffset - kHeapObjectTag`.  I was trying to find single source/constant instead of copying over a calculation.",
      "parentUuid": "b71cad20_0b70dc7c",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fcd8c248_73828362",
        "filename": "src/code-stub-assembler.cc",
        "patchSetId": 7
      },
      "lineNbr": 2013,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-02-01T01:13:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "374e4654_0d1cd183",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a6249ce_3f55e823",
        "filename": "src/code-stub-assembler.cc",
        "patchSetId": 7
      },
      "lineNbr": 2013,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-02-01T08:36:27Z",
      "side": 1,
      "message": "I think we could remove the external reference. Also feel free to add a named constant to FixedTypedArrayBase and update all callsites. Doesn\u0027t have to be in this CL though.",
      "parentUuid": "374e4654_0d1cd183",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d09acf54_ef3b76bf",
        "filename": "src/code-stub-assembler.cc",
        "patchSetId": 7
      },
      "lineNbr": 2013,
      "author": {
        "id": 1153590
      },
      "writtenOn": "2019-02-01T14:41:54Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "1a6249ce_3f55e823",
      "revId": "7fb6194b3daefeb7a8b2b88f8a2bc07ae8135d5d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}