{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "476ea02f_3c413a06",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1305811
      },
      "writtenOn": "2021-03-11T21:23:58Z",
      "side": 1,
      "message": "Hey Ulan, here\u0027s an alternate stab at the CodeEntry finalizer work, inspired by your prior suggestions to do a main-thread sweep. Some important notes;\n\n- With this approach, we seem to be able to handle clearing out flushed bytecode during the sweep phase. Looking into whether or not this is a reasonable expectation, or undefined behaviour. I\u0027ve removed the bytecode flush logic in the mean time.\n- The CodeMap is changed to be backed by a |multimap|, as the CodeMap may no longer delete CodeEntry objects that are currently being tracked (as we need to first deregister the finalizer on the isolate thread). Let me know your thoughts on this vs. posting a task to the isolate thread. We generally run into these collisions very infrequently, only for things like EmptyFunction.\n\nPTAL -- and thanks a bunch!",
      "revId": "61a9249f61ffcf5e59ce0d3d3a427551f87fe42d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}