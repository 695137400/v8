{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "642c8679_592204dd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1396836
      },
      "writtenOn": "2021-04-19T11:15:52Z",
      "side": 1,
      "message": "Hi Michael, hi Sigurd,\n\nI\u0027m adding the flag Â¨-fvisbility-hidden\" to the group of tests that use functionality from gtest that are declared as hidden. This should unblock the v8 deps roller for gtest.\n\nI\u0027ve also manually rolled gtest here, is that fine like that or should I remove the DEPS change, and let the autoroller do that later?\n\nSigurd, I\u0027m adding you too since Wolfgang mentioned that you both had a look at this.\n\nPTAL!",
      "revId": "1153e899c8c4f419556ffe9d469119065a8c68e6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "03898e35_468f93eb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1119600
      },
      "writtenOn": "2021-04-19T11:27:29Z",
      "side": 1,
      "message": "IIUC, this just sets visibility to hidden for crdtp and unittests.\n\nCould you comment on why this isn\u0027t going counter:\n\nif ((is_posix || is_fuchsia) \u0026\u0026\n    (v8_enable_backtrace || v8_monolithic || v8_expose_symbols)) {\n  v8_remove_configs +\u003d [ \"//build/config/gcc:symbol_visibility_hidden\" ]\n  v8_add_configs +\u003d [ \"//build/config/gcc:symbol_visibility_default\" ]\n}\n\nfrom\n\nhttps://source.chromium.org/chromium/chromium/src/+/master:v8/gni/v8.gni;l\u003d182;drc\u003de101c057af71c88e79256c31eab10b88466809e9\n\nMy impression was (but I might be wrong) that for these particular flags, we don\u0027t want a hidden visibility.\n\nTo test if things are still working: Are you getting the same quality stack-traces with e.g. v8_enable_backtrace in unittests with your change?\n\nLooking at the googletest documentation, I wonder if we defined the matchers \"correctly\", i.e. in the currently indented way, and whether this is causing the problem with the reference to the vtable we are seeing? I would have thought that googletest exports (i.e. makes explicitly visible) all symbols it expects to be used by implementations that use the library.\n\n",
      "revId": "1153e899c8c4f419556ffe9d469119065a8c68e6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "659f7287_03540cae",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1396836
      },
      "writtenOn": "2021-04-20T12:47:19Z",
      "side": 1,
      "message": "Thanks for your input Sigurd. I\u0027ve been looking more into this, and I agree that it\u0027s not the correct solution. I\u0027ll abandon the change, and add more information on the bug report itself!",
      "parentUuid": "03898e35_468f93eb",
      "revId": "1153e899c8c4f419556ffe9d469119065a8c68e6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4d72620a_deabf1be",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1119600
      },
      "writtenOn": "2021-04-20T12:54:07Z",
      "side": 1,
      "message": "Just for the record, looking at this CL I wasn\u0027t entirely sure this is the right solution, that\u0027s why I asked the questions. Looking forward to hear your rational (on the bug)!",
      "parentUuid": "659f7287_03540cae",
      "revId": "1153e899c8c4f419556ffe9d469119065a8c68e6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "563d402e_83e7da66",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1396836
      },
      "writtenOn": "2021-04-20T13:05:57Z",
      "side": 1,
      "message": "OH, one thing that I can add which is not relevant to the bug:\nthe tests are doing the correct thing, they are just using the matchers which is already correct (there\u0027s a better way using macros, but it is still OK to use the current way); I had a look after you mentioned it. The problem is the visibility setting which is enforced through the v8 build system (see bug).\n\nThanks to your concern I dug a bit deeper to better understand what happens, such that I can also agree that it\u0027s not the correct way.",
      "parentUuid": "4d72620a_deabf1be",
      "revId": "1153e899c8c4f419556ffe9d469119065a8c68e6",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}