{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c09b9421_aed39627",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-06-28T16:44:36Z",
      "side": 1,
      "message": "ptal. This should help with some of the regression we saw (which frankly are a bit noisy anyway).\n\nI wanted to run this on pinpoint but that\u0027s not possible because it requires CL in 2 different repos.\nIf we don\u0027t want to wait for everything to roll and see the effect on chrome perf, we can split this CL into 2 parts. The 1st will introduce the batched events and will land first. Then we land the blink-side CL. Finally we switch v8 to report batches. Running the 3rd CL in pinpoint after the other 2 have landed will be possible.\nwdyt?",
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4cbb3f08_874d8643",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-07-02T08:48:22Z",
      "side": 1,
      "message": "Oops, forgot to add reviewers.",
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa7fd718_abab01a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-07-02T09:03:02Z",
      "side": 1,
      "message": "Will ping once I update the impl to std::vector.",
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52f5003b_948f44db",
        "filename": "include/v8-metrics.h",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-06-28T16:44:36Z",
      "side": 1,
      "message": "I debated for a long time between using an array or std::vector here.\nI actually like std::vector better as it means we don\u0027t need to commit to a kMaxBatchedEvents value and we don\u0027t need to explicitly include |num_batched_events|.\nWent with the array approach in the end because I think the code is somewhat simpler and probably a bit faster.",
      "range": {
        "startLine": 53,
        "startChar": 7,
        "endLine": 53,
        "endChar": 60
      },
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8bf65a3b_71d45b5e",
        "filename": "include/v8-metrics.h",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 1131764
      },
      "writtenOn": "2021-07-02T08:58:05Z",
      "side": 1,
      "message": "I would suggest using std::vector to be more flexible with batch sizes and avoid exposing a maximum cosntant.\n\nWe can move `kMaxBatchedEvents` to the .cc file as implementation detail.\n\nWhy is the code simpler with the array?",
      "parentUuid": "52f5003b_948f44db",
      "range": {
        "startLine": 53,
        "startChar": 7,
        "endLine": 53,
        "endChar": 60
      },
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ff2f5b24_4fc130c5",
        "filename": "include/v8-metrics.h",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-07-02T09:03:02Z",
      "side": 1,
      "message": "The main complication was in trying to kMaxBatchedEvents the same everywhere.\nWe can report from either GCTracer or from CppHeap. I wanted them to have the same batch size and use the same constant. On the other hand I didn\u0027t want to add the constant to gc_tracer.h (i.e. keep it in the .cc file) which made it complicated.\nI think I will just have 2 constants now and add a comment in cpp_heap.cc pointing to gc_tracer.cc and saying that they should be the same value.",
      "parentUuid": "8bf65a3b_71d45b5e",
      "range": {
        "startLine": 53,
        "startChar": 7,
        "endLine": 53,
        "endChar": 60
      },
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7299346_b4412357",
        "filename": "src/heap/cppgc-js/cpp-heap.cc",
        "patchSetId": 2
      },
      "lineNbr": 254,
      "author": {
        "id": 1131764
      },
      "writtenOn": "2021-07-02T08:58:05Z",
      "side": 1,
      "message": "With vector, we should probably have std::move() here.",
      "range": {
        "startLine": 254,
        "startChar": 35,
        "endLine": 254,
        "endChar": 67
      },
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "839f2b52_823a1550",
        "filename": "src/heap/cppgc-js/cpp-heap.cc",
        "patchSetId": 2
      },
      "lineNbr": 254,
      "author": {
        "id": 1356087
      },
      "writtenOn": "2021-07-02T09:03:02Z",
      "side": 1,
      "message": "Indeed. std::vector with std::move also eliminates the need for memset below.",
      "parentUuid": "f7299346_b4412357",
      "range": {
        "startLine": 254,
        "startChar": 35,
        "endLine": 254,
        "endChar": 67
      },
      "revId": "39bf8178d5986eb410143ff9e820a779cecb1895",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}