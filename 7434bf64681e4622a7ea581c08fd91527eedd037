{
  "comments": [
    {
      "key": {
        "uuid": "718e2162_5c0b8516",
        "filename": "src/snapshot/embedded-file-writer.cc",
        "patchSetId": 2
      },
      "lineNbr": 288,
      "author": {
        "id": 1167239
      },
      "writtenOn": "2019-05-22T13:41:07Z",
      "side": 1,
      "message": "I think casting down to a subclass of an interface kind of defeats the point of the interface. A \u0027cleaner\u0027 alternative would be to have a DeclareRvaToSymbol method on PlatformEmbeddedFileWriterBase (possibly with a default implementation that does nothing) and then only override it for PlatformEmbeddedFileWriterWin. Then you don\u0027t need to cast the writer (i.e. don\u0027t need to worry about the impl, only the interface).\n\nThis is kind of difficult/contrived for things like StartXdataSection() which could only ever apply to windows. You could push more of this #ifdef\u0027d behaviour into the PlatformEmbeddedFileWriterWin subclass and then have a simpler call like PlatformEmbeddedFileWriterBase::WriteUnwindInfo(). But this kind of changes the definition of PlatformEmbeddedFileWriterBase which was meant to only write individual assembly instructions/lines.\n\nIf in the future we did want to add similar unwind info for mac/some other format, how would we do that? That might answer this question.\n\nSeems like this kind of comes back to merging PlatformEmbeddedFileWriterBase and EmbeddedFileWriter",
      "range": {
        "startLine": 288,
        "startChar": 18,
        "endLine": 288,
        "endChar": 47
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35fce0fe_a0b977b0",
        "filename": "src/snapshot/embedded-file-writer.cc",
        "patchSetId": 2
      },
      "lineNbr": 288,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-05-22T14:03:59Z",
      "side": 1,
      "message": "I have TODOs lying around somewhere to clean this up. The win64-specific code in this file is definitely a bit of an eyesore I\u0027d like to get rid of. Not sure yet how, but my initial thought was to move these platform-related things into the -win.cc impl. \n\nI don\u0027t expect us to add similar unwind mechanisms on other platforms.\n\nI can leave the TODO in L12 until this is cleaned up. Wdyt?",
      "parentUuid": "718e2162_5c0b8516",
      "range": {
        "startLine": 288,
        "startChar": 18,
        "endLine": 288,
        "endChar": 47
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6a2c3a14_ef36ba8d",
        "filename": "src/snapshot/embedded-file-writer.cc",
        "patchSetId": 2
      },
      "lineNbr": 288,
      "author": {
        "id": 1167239
      },
      "writtenOn": "2019-05-22T14:06:37Z",
      "side": 1,
      "message": "Sounds good thanks",
      "parentUuid": "35fce0fe_a0b977b0",
      "range": {
        "startLine": 288,
        "startChar": 18,
        "endLine": 288,
        "endChar": 47
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "98142eb1_b169f657",
        "filename": "src/snapshot/embedded/platform-embedded-file-writer-base.cc",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1167239
      },
      "writtenOn": "2019-05-22T13:41:07Z",
      "side": 1,
      "message": "Can\u0027t remember if this has an implicit constructor so that you can just return new X and it will get wrapped up automatically. Then you don\u0027t need to repeat std::unique_ptr\u003cPlatformEmbeddedFileWriterBase\u003e all the time. Possibly harder to read though.",
      "range": {
        "startLine": 103,
        "startChar": 16,
        "endLine": 103,
        "endChar": 26
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a441f18_e29806a1",
        "filename": "src/snapshot/embedded/platform-embedded-file-writer-base.cc",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2019-05-22T14:03:59Z",
      "side": 1,
      "message": "Oh I just realized we have our own base::make_unique implementation. I knew I\u0027ve seen that around and I was surprised when std::make_unique failed on bots (it\u0027s C++14). I\u0027ll change to base::make_unique.",
      "parentUuid": "98142eb1_b169f657",
      "range": {
        "startLine": 103,
        "startChar": 16,
        "endLine": 103,
        "endChar": 26
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "545240f7_135be451",
        "filename": "src/snapshot/embedded/platform-embedded-file-writer-base.cc",
        "patchSetId": 2
      },
      "lineNbr": 103,
      "author": {
        "id": 1167239
      },
      "writtenOn": "2019-05-22T14:06:37Z",
      "side": 1,
      "message": "SGTM!",
      "parentUuid": "1a441f18_e29806a1",
      "range": {
        "startLine": 103,
        "startChar": 16,
        "endLine": 103,
        "endChar": 26
      },
      "revId": "7434bf64681e4622a7ea581c08fd91527eedd037",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}