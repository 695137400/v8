{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "880c3d7a_2c595d5d",
        "filename": "src/logging/log.cc",
        "patchSetId": 1
      },
      "lineNbr": 2141,
      "author": {
        "id": 1472029
      },
      "writtenOn": "2022-09-19T18:03:57Z",
      "side": 1,
      "message": "Class ExistingCodeLogger uses a macro CALL_CODE_EVENT_HANDLER that logs to the registered listener_ or to the V8FileLogger, if no listener is assigned.\nHere we set the listener when a ETW trace session starts. This means that if were also logging code events to a log file (with --log-code), the logging to file would be replaced by ETW tracing.\nIf this is not the correct behavior and we want to support both kind of loggings together, we\u0027ll need to modify the CALL_CODE_EVENT_HANDLER macro.",
      "range": {
        "startLine": 2141,
        "startChar": 4,
        "endLine": 2141,
        "endChar": 61
      },
      "revId": "b322f7cece443e4d6f3b4b7d3c8acd9e3a579915",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5137d0a_df9b3490",
        "filename": "src/logging/log.cc",
        "patchSetId": 1
      },
      "lineNbr": 2141,
      "author": {
        "id": 1132654
      },
      "writtenOn": "2022-09-20T08:01:41Z",
      "side": 1,
      "message": "I think it makes sense to clean this up:\n\n- Move those whole logic into a separate ETWJitLogger (that extends JitLogger)\n- Use an internal ExistingCodeLogger there to not interfere with the v8-file-logger\n\nThis way this can be disentangled a bit easier in the future.\n\nNote: I\u0027ve still a plan to clean up the logging infra [1]. Mainly the v8-file-logger should no longer be the central piece, instead multiple loggare are attached to isolate-\u003elogger() and that\u0027s it.\n\n\n[1] http://doc/1rGpYWAdpeQbGDsCI4PSU4AG_yoeW8QSFoZnxX8YN580",
      "parentUuid": "880c3d7a_2c595d5d",
      "range": {
        "startLine": 2141,
        "startChar": 4,
        "endLine": 2141,
        "endChar": 61
      },
      "revId": "b322f7cece443e4d6f3b4b7d3c8acd9e3a579915",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6dead21a_43d38b79",
        "filename": "src/logging/log.cc",
        "patchSetId": 1
      },
      "lineNbr": 2141,
      "author": {
        "id": 1472029
      },
      "writtenOn": "2022-09-21T00:55:07Z",
      "side": 1,
      "message": "I cannot access http://doc/..., unfortunately :)\n\nI have introduced a class ETWJitLogger but I was actually wrong, we don\u0027t need to set the listener in existing_code_logger. When it is null, the macro \n\n#define CALL_CODE_EVENT_HANDLER(Call) \\\n  if (listener_) {                    \\\n    listener_-\u003eCall;                  \\\n  } else {                            \\\n    PROFILE(isolate_, Call);          \\\n  }\n#define PROFILE(the_isolate, Call) (the_isolate)-\u003elogger()-\u003eCall;\n\ncalls isolate_-\u003elogger()-\u003eCall\nwhich calls the log function on all listeners. And we have added the ETWJitLogger to the listeners of the isolate logger.\nSo the code can be simplified.",
      "parentUuid": "b5137d0a_df9b3490",
      "range": {
        "startLine": 2141,
        "startChar": 4,
        "endLine": 2141,
        "endChar": 61
      },
      "revId": "b322f7cece443e4d6f3b4b7d3c8acd9e3a579915",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}