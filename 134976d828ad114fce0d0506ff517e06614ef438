{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c79a41e6_488a1bc7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 35
      },
      "lineNbr": 0,
      "author": {
        "id": 1531727
      },
      "writtenOn": "2022-07-19T11:49:35Z",
      "side": 1,
      "message": "Thanks for Igor\u0027s comments, Now I try to refactor the PKU for WASM, PTAL, thanks!\n\nThere is another problem this CL failed in v8_linux64_shared_compile_rel bot, it was failed in link cctest, but I found it was passed in other bot with cctest, I don\u0027t know why it failed, I am really appreciated if you could give me any insights.",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eb70f7d1_29b6f9ae",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 35
      },
      "lineNbr": 0,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-19T14:22:22Z",
      "side": 1,
      "message": "Thank you! The CL mostly looks good to me modulo nits and the issue with ResetPKUPermissionsForThreadSpawning.\n\nPlease address my comments and then let\u0027s pull Clemens into the discussion re Wasm changes.",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45e1a28e_b56e53c0",
        "filename": "src/common/code-memory-access.h",
        "patchSetId": 35
      },
      "lineNbr": 111,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-19T14:22:22Z",
      "side": 1,
      "message": "Please move definitions of these methods back to .cc file. The goal is to avoid inlining implementations of the RwxMemoryWriteScope\u0027s ctor/dtor to other components. See the comment above.",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "104f9e7d_9684d231",
        "filename": "src/common/code-memory-access.h",
        "patchSetId": 35
      },
      "lineNbr": 111,
      "author": {
        "id": 1531727
      },
      "writtenOn": "2022-07-20T04:43:22Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "45e1a28e_b56e53c0",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bfab6e82_47a00ac5",
        "filename": "src/common/code-memory-access.h",
        "patchSetId": 35
      },
      "lineNbr": 111,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-20T09:37:41Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "104f9e7d_9684d231",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44e3bbec_ac1d04a1",
        "filename": "src/wasm/code-space-access.cc",
        "patchSetId": 35
      },
      "lineNbr": 103,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-19T14:22:22Z",
      "side": 1,
      "message": "There might be an issue here. The RwxMemoryWriteScope::SetExecutable() counts how many times was RwxMemoryWriteScope created and if there will be more than one RwxMemoryWriteScope active on the stack then this call will just decrease the counter but not actually modify the permissions.\n\nWe might want to call base::MemoryProtectionKey::SetPermissionsForKey() from here directly. We could have exposed this specific call from RwxMemoryWriteScope but I don\u0027t think it makes sense.\n\nClemens, WDYT?",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b6b1e38_d11aed8b",
        "filename": "src/wasm/code-space-access.cc",
        "patchSetId": 35
      },
      "lineNbr": 103,
      "author": {
        "id": 1177599
      },
      "writtenOn": "2022-07-21T11:01:07Z",
      "side": 1,
      "message": "Yes, this is valid concern. I think we should move The `ResetPKUPermissionsForThreadSpawning` class to `src/common/code-memory-access.h` and implement it without using the `RwxMemoryWriteScope` methods.",
      "parentUuid": "44e3bbec_ac1d04a1",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81fe2342_c3384e33",
        "filename": "src/wasm/code-space-access.cc",
        "patchSetId": 35
      },
      "lineNbr": 103,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-21T11:38:54Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "8b6b1e38_d11aed8b",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e439b97d_5a6f0965",
        "filename": "src/wasm/code-space-access.cc",
        "patchSetId": 35
      },
      "lineNbr": 103,
      "author": {
        "id": 1531727
      },
      "writtenOn": "2022-07-22T07:14:36Z",
      "side": 1,
      "message": "I moved `ResetPKUPermissionsForThreadSpawning` to `src/common/code-memory-access.h` and call `base::MemoryProtectionKey` APIs directlly.",
      "parentUuid": "81fe2342_c3384e33",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eab4c4fe_9a6e9be3",
        "filename": "src/wasm/code-space-access.cc",
        "patchSetId": 35
      },
      "lineNbr": 103,
      "author": {
        "id": 1177599
      },
      "writtenOn": "2022-07-22T07:30:08Z",
      "side": 1,
      "message": "Thanks.",
      "parentUuid": "e439b97d_5a6f0965",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "295ea8a7_b4074419",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 1949,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-19T14:22:22Z",
      "side": 1,
      "message": "#else\n  UNREACHABLE();",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9112eb0_f2b0ccf5",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 1949,
      "author": {
        "id": 1531727
      },
      "writtenOn": "2022-07-20T04:43:22Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "295ea8a7_b4074419",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "65866152_b9888e72",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 1949,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-20T09:37:41Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b9112eb0_f2b0ccf5",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7716de1_24ae2496",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 2147,
      "author": {
        "id": 1183889
      },
      "writtenOn": "2022-07-19T14:22:22Z",
      "side": 1,
      "message": "This and below predicates can also be made static.\n\nClemens, WDYT?",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab566ca7_0a1c3baf",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 2147,
      "author": {
        "id": 1177599
      },
      "writtenOn": "2022-07-25T10:36:06Z",
      "side": 1,
      "message": "Sure, why not!",
      "parentUuid": "e7716de1_24ae2496",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2ccd38e9_a1b0dfd5",
        "filename": "src/wasm/wasm-code-manager.cc",
        "patchSetId": 35
      },
      "lineNbr": 2147,
      "author": {
        "id": 1531727
      },
      "writtenOn": "2022-07-25T13:11:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ab566ca7_0a1c3baf",
      "revId": "134976d828ad114fce0d0506ff517e06614ef438",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}