{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "79faf672_6d17a415",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 13
      },
      "lineNbr": 0,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-12T16:27:16Z",
      "side": 1,
      "message": "Thanks Jakob, I addressed most of the comments and added replies to others. PTAL.\n\nThanks,\nMythri",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c5582fcd_256a517d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 13
      },
      "lineNbr": 0,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "Looking good overall, a couple of comments.",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21534efd_4678b672",
        "filename": "src/codegen/compiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 2998,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "Hmm could we keep interrupt budgets the same and instead use different profiler ticks for each tier? That way we wouldn\u0027t need to do this scaling here. We would need to interrupt code 10 times as much as currently, but if I remember correctly, we tried that before and didn\u0027t have much perf impact.",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be67ad4a_8370730a",
        "filename": "src/codegen/compiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 2998,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2020-10-13T05:11:42Z",
      "side": 1,
      "message": "Budget increments could also differ, e.g. bytecode could inc/dec by x*10 while TP could inc/dec by x (where x is the amount that ignition currently incs/decs by).",
      "parentUuid": "21534efd_4678b672",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6496ec46_157571d1",
        "filename": "src/codegen/compiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 2998,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "I like the idea of using different increments. I slightly prefer using x/10 for TP so we don\u0027t have to use wide / extra wide opcodes when not needed. Though using x/10 would have rounding off errors, so won\u0027t be as accurate as earlier but I guess that should be OK? WDYT?\n\nFor now, I am just removing this and simply not resetting the profiler ticks when we need to tier up. In a follow up cl, I will implement either scaling interrupt budget or using different profiler ticks for each tier.",
      "parentUuid": "be67ad4a_8370730a",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6a1f433_85403963",
        "filename": "src/codegen/compiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 2998,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2020-10-14T05:16:05Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "6496ec46_157571d1",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "997c4496_c04471b2",
        "filename": "src/compiler/bytecode-graph-builder.cc",
        "patchSetId": 13
      },
      "lineNbr": 4059,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "This doesn\u0027t seem like the right check - updating the interrupt budget isn\u0027t really about whether it checks the optimization marker. Can we make this CodeKindCanTierUp or something similar?",
      "range": {
        "startLine": 4059,
        "startChar": 7,
        "endLine": 4059,
        "endChar": 39
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b208b82e_7e50af2e",
        "filename": "src/compiler/bytecode-graph-builder.cc",
        "patchSetId": 13
      },
      "lineNbr": 4059,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "I renamed the function. Let me know if you meant adding another function.",
      "parentUuid": "997c4496_c04471b2",
      "range": {
        "startLine": 4059,
        "startChar": 7,
        "endLine": 4059,
        "endChar": 39
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c49229e3_fe1cb2bd",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 107,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "It seems strange to have specific tracing for NCI code here. Can\u0027t we have some context in trace-opt that allows us to extra the same data?",
      "range": {
        "startLine": 105,
        "startChar": 2,
        "endLine": 107,
        "endChar": 3
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f628c066_84e26656",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 107,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2020-10-13T05:11:42Z",
      "side": 1,
      "message": "Something similar to tracing in compiler.cc would work, there we print the code kind: https://source.chromium.org/chromium/chromium/src/+/master:v8/src/codegen/compiler.cc;l\u003d98;drc\u003de5ea75ba76df2c306f03373a1ca6332898f5b37b\n\nThat said, I\u0027d kinda prefer we keep the dedicated NCI tracing at this spot at least temporarily, since it means I don\u0027t have to dig through a (still fairly noisy) --trace-opt output to reconstruct NCI lifecycles.",
      "parentUuid": "c49229e3_fe1cb2bd",
      "range": {
        "startLine": 105,
        "startChar": 2,
        "endLine": 107,
        "endChar": 3
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68a6e9fa_20f3eac7",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 107,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "I am leaving this as is. Let me know if it\u0027s better to move it back to MaybeOptimizeFrame just before Optimize call (on line 192)",
      "parentUuid": "f628c066_84e26656",
      "range": {
        "startLine": 105,
        "startChar": 2,
        "endLine": 107,
        "endChar": 3
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d362d00d_922e514c",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 107,
      "author": {
        "id": 1162439
      },
      "writtenOn": "2020-10-14T05:16:05Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "68a6e9fa_20f3eac7",
      "range": {
        "startLine": 105,
        "startChar": 2,
        "endLine": 107,
        "endChar": 3
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "782f589c_a480f2f7",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 159,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "DCHECK(CodeKindCanTierUp(code_kind));",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9578173b_026066e1",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 159,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "782f589c_a480f2f7",
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1bca552d_fe28bdf7",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 304,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "Can we use the similar CodeKindCanTierUp function here?",
      "range": {
        "startLine": 303,
        "startChar": 8,
        "endLine": 304,
        "endChar": 40
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "21f1e7a5_caf4c60c",
        "filename": "src/execution/runtime-profiler.cc",
        "patchSetId": 13
      },
      "lineNbr": 304,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1bca552d_fe28bdf7",
      "range": {
        "startLine": 303,
        "startChar": 8,
        "endLine": 304,
        "endChar": 40
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67df88c9_dcbca9fc",
        "filename": "src/objects/js-function.cc",
        "patchSetId": 13
      },
      "lineNbr": 306,
      "author": {
        "id": 1002763
      },
      "writtenOn": "2020-10-12T17:41:11Z",
      "side": 1,
      "message": "It would be great if we could keep the logic for FLAG_interrupt_budget_for_midtier vs FLAG_interrupt_budget in one place - i.e., maybe we pass an enum to SetInterruptBudget to determine what we use there?",
      "range": {
        "startLine": 306,
        "startChar": 51,
        "endLine": 306,
        "endChar": 52
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0d67578c_8ab3b12d",
        "filename": "src/objects/js-function.cc",
        "patchSetId": 13
      },
      "lineNbr": 306,
      "author": {
        "id": 1145189
      },
      "writtenOn": "2020-10-13T13:22:08Z",
      "side": 1,
      "message": "Done. We no longer need different budgets.",
      "parentUuid": "67df88c9_dcbca9fc",
      "range": {
        "startLine": 306,
        "startChar": 51,
        "endLine": 306,
        "endChar": 52
      },
      "revId": "e385085d0ba99ada7a15e51d28b11d6756f04410",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}